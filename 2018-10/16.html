<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>16일 | Jung&#39;s TIL</title>
    <meta name="description" content="Today I Learn">
    
    
    <link rel="preload" href="/TIL/assets/css/0.styles.22c548d5.css" as="style"><link rel="preload" href="/TIL/assets/js/app.8d80df15.js" as="script"><link rel="preload" href="/TIL/assets/js/21.1213b57d.js" as="script"><link rel="prefetch" href="/TIL/assets/js/10.ccb7b06d.js"><link rel="prefetch" href="/TIL/assets/js/11.df535cee.js"><link rel="prefetch" href="/TIL/assets/js/12.bcd134b3.js"><link rel="prefetch" href="/TIL/assets/js/13.5278acca.js"><link rel="prefetch" href="/TIL/assets/js/14.b986e5b6.js"><link rel="prefetch" href="/TIL/assets/js/15.46503adc.js"><link rel="prefetch" href="/TIL/assets/js/16.8f959262.js"><link rel="prefetch" href="/TIL/assets/js/17.4cf6d4c7.js"><link rel="prefetch" href="/TIL/assets/js/18.09825af2.js"><link rel="prefetch" href="/TIL/assets/js/19.56a1c588.js"><link rel="prefetch" href="/TIL/assets/js/2.831e6211.js"><link rel="prefetch" href="/TIL/assets/js/20.8b60de2b.js"><link rel="prefetch" href="/TIL/assets/js/22.f5b1f847.js"><link rel="prefetch" href="/TIL/assets/js/23.eb9c43bf.js"><link rel="prefetch" href="/TIL/assets/js/24.d5176db0.js"><link rel="prefetch" href="/TIL/assets/js/25.60fb377b.js"><link rel="prefetch" href="/TIL/assets/js/26.108e2ee6.js"><link rel="prefetch" href="/TIL/assets/js/27.0241a564.js"><link rel="prefetch" href="/TIL/assets/js/28.2c597171.js"><link rel="prefetch" href="/TIL/assets/js/29.34a241d3.js"><link rel="prefetch" href="/TIL/assets/js/3.327b1eb9.js"><link rel="prefetch" href="/TIL/assets/js/4.d102f89a.js"><link rel="prefetch" href="/TIL/assets/js/5.6afc2547.js"><link rel="prefetch" href="/TIL/assets/js/6.6939c119.js"><link rel="prefetch" href="/TIL/assets/js/7.5867cd1b.js"><link rel="prefetch" href="/TIL/assets/js/8.0665ccf0.js"><link rel="prefetch" href="/TIL/assets/js/9.bb7cb2a8.js">
    <link rel="stylesheet" href="/TIL/assets/css/0.styles.22c548d5.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/TIL/" class="home-link router-link-active"><!----> <span class="site-name">Jung's TIL</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://github.com/junghanyoung" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://junghanyoung.github.io/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Blog
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://github.com/junghanyoung" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://junghanyoung.github.io/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Blog
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first collapsable"><p class="sidebar-heading"><span>2018-09</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading open"><span>2018-10</span> <span class="arrow down"></span></p> <ul class="sidebar-group-items"><li><a href="/TIL/2018-10/01.html" class="sidebar-link">1일</a></li><li><a href="/TIL/2018-10/02.html" class="sidebar-link">2일</a></li><li><a href="/TIL/2018-10/03.html" class="sidebar-link">3일</a></li><li><a href="/TIL/2018-10/04.html" class="sidebar-link">4일</a></li><li><a href="/TIL/2018-10/05.html" class="sidebar-link">5일</a></li><li><a href="/TIL/2018-10/07.html" class="sidebar-link">7일</a></li><li><a href="/TIL/2018-10/08.html" class="sidebar-link">8일</a></li><li><a href="/TIL/2018-10/09.html" class="sidebar-link">9일</a></li><li><a href="/TIL/2018-10/11.html" class="sidebar-link">11일</a></li><li><a href="/TIL/2018-10/16.html" class="active sidebar-link">16일</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/TIL/2018-10/16.html#윈도우즈-시스템-프로그래밍" class="sidebar-link">윈도우즈 시스템 프로그래밍</a></li></ul></li><li><a href="/TIL/2018-10/17.html" class="sidebar-link">17일</a></li><li><a href="/TIL/2018-10/18.html" class="sidebar-link">18일</a></li><li><a href="/TIL/2018-10/28.html" class="sidebar-link">28일</a></li></ul></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>2018-12</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>2019-02</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>2021-11</span> <span class="arrow right"></span></p> <!----></div></li></ul> </div> <div class="page"> <div class="content"><p></p><div class="table-of-contents"><ul><li><a href="#윈도우즈-시스템-프로그래밍">윈도우즈 시스템 프로그래밍</a><ul><li><a href="#windows에서의-유니코드">Windows에서의 유니코드</a><ul><li><a href="#문자셋의-종류와-특성">문자셋의 종류와 특성</a></li><li><a href="#기존-sbcs-mbcs의-프로그래밍">기존 SBCS, MBCS의 프로그래밍</a></li><li><a href="#wbcs-기반의-프로그래밍">WBCS 기반의 프로그래밍</a></li></ul></li><li><a href="#mbcs-sbcs-와-wbcs의-동시지원">MBCS(SBCS)와 WBCS의 동시지원</a><ul><li><a href="#mbcs와-wbcs-동시-지원-매크로1-타입정의">MBCS와 WBCS 동시 지원 매크로1 - 타입정의</a></li><li><a href="#mbcs와-wbcs-동시-지원-매크로2-문자열선언">MBCS와 WBCS 동시 지원 매크로2 - 문자열선언</a></li></ul></li></ul></li></ul></div><p></p> <h2 id="윈도우즈-시스템-프로그래밍"><a href="#윈도우즈-시스템-프로그래밍" aria-hidden="true" class="header-anchor">#</a> 윈도우즈 시스템 프로그래밍</h2> <h3 id="windows에서의-유니코드"><a href="#windows에서의-유니코드" aria-hidden="true" class="header-anchor">#</a> Windows에서의 유니코드</h3> <h4 id="문자셋의-종류와-특성"><a href="#문자셋의-종류와-특성" aria-hidden="true" class="header-anchor">#</a> 문자셋의 종류와 특성</h4> <table><thead><tr><th>SBCS</th> <th>MBCS</th> <th>WBCS</th></tr></thead> <tbody><tr><td>문자당 1바이트</td> <td>한글은 2바이트, 영문은 1바이트</td> <td>문자당 2바이트</td></tr> <tr><td>아스키코드</td> <td></td> <td>유니코드</td></tr></tbody></table> <p>-&gt; macOS에서만 그런지 몰라도 여기선 한글을 3바이트로 인식하는 듯함.</p> <br> <h4 id="기존-sbcs-mbcs의-프로그래밍"><a href="#기존-sbcs-mbcs의-프로그래밍" aria-hidden="true" class="header-anchor">#</a> 기존 SBCS, MBCS의 프로그래밍</h4> <div class="language-C line-numbers-mode"><pre class="language-c"><code><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;string.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span> argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">char</span> str<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;ABC한글&quot;</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> size <span class="token operator">=</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> len <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;배열의 크기: %d \n&quot;</span><span class="token punctuation">,</span> size<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;문자열 길이: %d \n&quot;</span><span class="token punctuation">,</span> len<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

배열의 크기<span class="token punctuation">:</span> <span class="token number">10</span> 
문자열 길이<span class="token punctuation">:</span> <span class="token number">9</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>문자셋이 SBCS로 확인되긴 하는데 뭔가 이상한데?</p> <p>배열의 크기: 10 -&gt; ABC: 1x3, 한글: 2x2, null: 1*1 = 8 ...?
문자열길이: 9? 왜지?</p> <div class="language-C line-numbers-mode"><pre class="language-c"><code><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;string.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span> argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">char</span> str<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;한&quot;</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> size <span class="token operator">=</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> len <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;배열의 크기: %d \n&quot;</span><span class="token punctuation">,</span> size<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;문자열 길이: %d \n&quot;</span><span class="token punctuation">,</span> len<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

배열의 크기<span class="token punctuation">:</span> <span class="token number">4</span> 
문자열 길이<span class="token punctuation">:</span> <span class="token number">3</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>쯥... 보니까 한글이 3바이트를 차지하는 것으로 보임.(macOS Xcode)</p> <p>배열의 크기: 4 -&gt; 한글: 3x1, null: 1x1 = 4</p> <p>한글이 2바이트 인줄 알았지만, 3바이트를 차지하는 것으로 확인되었다.</p> <ul><li>char타입당 1바이트 이기 때문에 한글 한글자당 길이 3으로 인식</li></ul> <div class="language-C line-numbers-mode"><pre class="language-c"><code><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;string.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span> argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">char</span> str<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;한글입니다&quot;</span><span class="token punctuation">;</span>
    
    <span class="token keyword">int</span> i<span class="token punctuation">;</span>
    
    <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span> <span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token number">10</span> <span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token function">fputc</span><span class="token punctuation">(</span>str<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token constant">stdout</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token function">fputs</span><span class="token punctuation">(</span><span class="token string">&quot;\n&quot;</span><span class="token punctuation">,</span> <span class="token constant">stdout</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span> <span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token number">15</span> <span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token function">fputc</span><span class="token punctuation">(</span>str<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token constant">stdout</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token function">fputs</span><span class="token punctuation">(</span><span class="token string">&quot;\n&quot;</span><span class="token punctuation">,</span> <span class="token constant">stdout</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

한글입\<span class="token number">353</span>
한글입니다
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>한글이 3바이트라 x3의 배열 크기로</p> <p>아무튼 두 개의 코드 모두 SBCS 문자셋 기반으로 동작하는 것으로 보인다.</p> <br> <h4 id="wbcs-기반의-프로그래밍"><a href="#wbcs-기반의-프로그래밍" aria-hidden="true" class="header-anchor">#</a> WBCS 기반의 프로그래밍</h4> <ul><li>char 대신 wchar_t</li> <li>&quot;ABC&quot; 대신 L&quot;ABC&quot;
<ul><li>wchar_t str[] = L&quot;ABC&quot;;</li></ul></li></ul> <div class="language-C line-numbers-mode"><pre class="language-c"><code><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;wchar.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    wchar_t str<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> L<span class="token string">&quot;ABC&quot;</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> size <span class="token operator">=</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> len <span class="token operator">=</span> <span class="token function">wcslen</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;배열의 크기: %d \n&quot;</span><span class="token punctuation">,</span> size<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;문자열 길이: %d \n&quot;</span><span class="token punctuation">,</span> len<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


배열의 크기<span class="token punctuation">:</span> <span class="token number">16</span> 
문자열 길이<span class="token punctuation">:</span> <span class="token number">3</span>      
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>메모리 크기는 이전과 같고, 문자열 길이가 달라진 것을 알 수 있다!</p> <br> <h3 id="mbcs-sbcs-와-wbcs의-동시지원"><a href="#mbcs-sbcs-와-wbcs의-동시지원" aria-hidden="true" class="header-anchor">#</a> MBCS(SBCS)와 WBCS의 동시지원</h3> <ul><li>windows.h안에 정의된 자료형
<ul><li>#include &lt;windows.h&gt; 선언</li></ul></li></ul> <div class="language-C line-numbers-mode"><pre class="language-c"><code><span class="token keyword">typedef</span> <span class="token keyword">char</span>    CHAR<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> wchar_t WCHAR<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language-C line-numbers-mode"><pre class="language-c"><code><span class="token comment">// WinString.cpp참조</span>
<span class="token macro property">#<span class="token directive keyword">define</span> CONST   const</span>

<span class="token keyword">typedef</span> CHAR <span class="token operator">*</span>      LPSTR<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> CONST CHAR <span class="token operator">*</span> LPCSTR<span class="token punctuation">;</span>

<span class="token keyword">typedef</span> WCHAR <span class="token operator">*</span>     LPWSTR<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> CONST WCHAR <span class="token operator">*</span>  LPCWSTR<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><ul><li>SBCS와 WBCS 문자셋 관련 typedef</li> <li>위에 해당하는 두 개의 typedef를 하나의 type으로 정의</li></ul> <br> <h4 id="mbcs와-wbcs-동시-지원-매크로1-타입정의"><a href="#mbcs와-wbcs-동시-지원-매크로1-타입정의" aria-hidden="true" class="header-anchor">#</a> MBCS와 WBCS 동시 지원 매크로1 - 타입정의</h4> <div class="language-C line-numbers-mode"><pre class="language-c"><code><span class="token macro property">#<span class="token directive keyword">ifdef</span>  UNICODE</span>
    <span class="token keyword">typedef</span> WCHAR   TCHAR<span class="token punctuation">;</span>
    <span class="token keyword">typedef</span> LPWSTR  LPTSTR<span class="token punctuation">;</span>
    <span class="token keyword">typedef</span> LPCWSTR LPCTSTR<span class="token punctuation">;</span>
<span class="token macro property">#<span class="token directive keyword">else</span></span>
    <span class="token keyword">typedef</span> CHAR    TCHAR<span class="token punctuation">;</span>
    <span class="token keyword">typedef</span> LPSTR   LPTSTR<span class="token punctuation">;</span>
    <span class="token keyword">typedef</span> LPCSTR  LPCTSTR<span class="token punctuation">;</span>
<span class="token macro property">#<span class="token directive keyword">endif</span></span>

<span class="token comment">// TCHAR, LPTSTR, LPCTSTR 하나로 통합</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>매크로 UNICODE가 정의되면</p> <p>TCHAR arr[10];  -&gt;  WCHAR arr[10];  -&gt;  wchar_t arr[10];</p> <p>매크로 UNICODE가 정의되지 않으면</p> <p>TCHAR arr[10];  -&gt;  CHAR arr[10];  -&gt;  char arr[10];</p> <ul><li>TCHAR로 정의하면 매크로를 통해 MBCS, WBCS 결정</li></ul> <br> <h4 id="mbcs와-wbcs-동시-지원-매크로2-문자열선언"><a href="#mbcs와-wbcs-동시-지원-매크로2-문자열선언" aria-hidden="true" class="header-anchor">#</a> MBCS와 WBCS 동시 지원 매크로2 - 문자열선언</h4> <div class="language-C line-numbers-mode"><pre class="language-c"><code><span class="token macro property">#<span class="token directive keyword">ifdef</span> _UNICODE</span>
    <span class="token macro property">#<span class="token directive keyword">define</span> __T(x)  L##x</span>
<span class="token macro property">#<span class="token directive keyword">else</span></span>
    <span class="token macro property">#<span class="token directive keyword">define</span> __T(x)  x</span>
<span class="token macro property">#<span class="token directive keyword">endif</span></span>

<span class="token macro property">#<span class="token directive keyword">define</span> _T(x)    __T(x)</span>
<span class="token macro property">#<span class="token directive keyword">define</span> _TEXT(x) __T(x)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>매크로 _UNICODE 정의시</p> <p>_T(&quot;HANBIT&quot;); -&gt; __T(&quot;HANBIT&quot;); -&gt; L&quot;HANBIT&quot;</p> <p>매크로 _UNICODE 정의 안되있을 시</p> <p>_T(&quot;HANBIT&quot;); -&gt; __T(&quot;HANBIT&quot;); -&gt; &quot;HANBIT&quot;</p> <div class="language-C line-numbers-mode"><pre class="language-c"><code><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token macro property">#<span class="token directive keyword">define</span> UNICODE</span>
<span class="token macro property">#<span class="token directive keyword">define</span> _UNICODE</span>

<span class="token keyword">int</span> <span class="token function">wmain</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    TCHAR str<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">_T</span><span class="token punctuation">(</span><span class="token string">&quot;1234567&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> size <span class="token operator">=</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;string length: %d \n&quot;</span><span class="token punctuation">,</span> size<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


결과값
string length<span class="token punctuation">:</span> <span class="token number">16</span>

<span class="token comment">// xcode에서 돌리려니 windows.h 헤더파일이 없어</span>
<span class="token comment">// 해당 로직을 수행할 수가 없다.</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div></div> <div class="page-edit"><!----> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/TIL/2018-10/11.html" class="prev">
          11일
        </a></span> <span class="next"><a href="/TIL/2018-10/17.html">
          17일
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/TIL/assets/js/app.8d80df15.js" defer></script><script src="/TIL/assets/js/21.1213b57d.js" defer></script>
  </body>
</html>
