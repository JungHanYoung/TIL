<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>2021년 11월 25일 | Jung&#39;s TIL</title>
    <meta name="description" content="Today I Learn">
    
    
    <link rel="preload" href="/TIL/assets/css/0.styles.22c548d5.css" as="style"><link rel="preload" href="/TIL/assets/js/app.8d80df15.js" as="script"><link rel="preload" href="/TIL/assets/js/17.4cf6d4c7.js" as="script"><link rel="prefetch" href="/TIL/assets/js/10.ccb7b06d.js"><link rel="prefetch" href="/TIL/assets/js/11.df535cee.js"><link rel="prefetch" href="/TIL/assets/js/12.bcd134b3.js"><link rel="prefetch" href="/TIL/assets/js/13.5278acca.js"><link rel="prefetch" href="/TIL/assets/js/14.b986e5b6.js"><link rel="prefetch" href="/TIL/assets/js/15.46503adc.js"><link rel="prefetch" href="/TIL/assets/js/16.8f959262.js"><link rel="prefetch" href="/TIL/assets/js/18.09825af2.js"><link rel="prefetch" href="/TIL/assets/js/19.56a1c588.js"><link rel="prefetch" href="/TIL/assets/js/2.831e6211.js"><link rel="prefetch" href="/TIL/assets/js/20.8b60de2b.js"><link rel="prefetch" href="/TIL/assets/js/21.1213b57d.js"><link rel="prefetch" href="/TIL/assets/js/22.f5b1f847.js"><link rel="prefetch" href="/TIL/assets/js/23.eb9c43bf.js"><link rel="prefetch" href="/TIL/assets/js/24.d5176db0.js"><link rel="prefetch" href="/TIL/assets/js/25.60fb377b.js"><link rel="prefetch" href="/TIL/assets/js/26.108e2ee6.js"><link rel="prefetch" href="/TIL/assets/js/27.0241a564.js"><link rel="prefetch" href="/TIL/assets/js/28.2c597171.js"><link rel="prefetch" href="/TIL/assets/js/29.34a241d3.js"><link rel="prefetch" href="/TIL/assets/js/3.327b1eb9.js"><link rel="prefetch" href="/TIL/assets/js/4.d102f89a.js"><link rel="prefetch" href="/TIL/assets/js/5.6afc2547.js"><link rel="prefetch" href="/TIL/assets/js/6.6939c119.js"><link rel="prefetch" href="/TIL/assets/js/7.5867cd1b.js"><link rel="prefetch" href="/TIL/assets/js/8.0665ccf0.js"><link rel="prefetch" href="/TIL/assets/js/9.bb7cb2a8.js">
    <link rel="stylesheet" href="/TIL/assets/css/0.styles.22c548d5.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/TIL/" class="home-link router-link-active"><!----> <span class="site-name">Jung's TIL</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://github.com/junghanyoung" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://junghanyoung.github.io/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Blog
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://github.com/junghanyoung" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://junghanyoung.github.io/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Blog
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first collapsable"><p class="sidebar-heading"><span>2018-09</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>2018-10</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>2018-12</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>2019-02</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading open"><span>2021-11</span> <span class="arrow down"></span></p> <ul class="sidebar-group-items"><li><a href="/TIL/2021-11/23.html" class="sidebar-link">2021년 11월 23일</a></li><li><a href="/TIL/2021-11/24.html" class="sidebar-link">2021년 11월 24일</a></li><li><a href="/TIL/2021-11/25.html" class="active sidebar-link">2021년 11월 25일</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/TIL/2021-11/25.html#브랜치-전략-git-flow-github-flow" class="sidebar-link">브랜치 전략(git flow, github flow)</a></li><li class="sidebar-sub-header"><a href="/TIL/2021-11/25.html#내-서비스를-github-action-을-통해-heorku-에-자동-배포해보기" class="sidebar-link">내 서비스를 Github Action 을 통해 Heorku 에 자동 배포해보기</a></li></ul></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><p></p><div class="table-of-contents"><ul><li><a href="#브랜치-전략-git-flow-github-flow">브랜치 전략(git flow, github flow)</a><ul><li><a href="#git-flow">git flow</a></li><li><a href="#github-flow">github flow</a></li></ul></li><li><a href="#내-서비스를-github-action-을-통해-heorku-에-자동-배포해보기">내 서비스를 Github Action 을 통해 Heorku 에 자동 배포해보기</a><ul><li><a href="#heroku-란">Heroku 란?</a></li><li><a href="#heroku-배포방법">Heroku 배포방법</a></li><li><a href="#github-action-을-사용하는-이유">Github Action 을 사용하는 이유</a></li><li><a href="#spring-boot-앱-자동-배포-시작">Spring Boot 앱 자동 배포 시작</a><ul><li><a href="#heroku-api-키-보안">Heroku API 키 보안</a></li></ul></li></ul></li></ul></div><p></p> <h2 id="브랜치-전략-git-flow-github-flow"><a href="#브랜치-전략-git-flow-github-flow" aria-hidden="true" class="header-anchor">#</a> 브랜치 전략(git flow, github flow)</h2> <h3 id="git-flow"><a href="#git-flow" aria-hidden="true" class="header-anchor">#</a> git flow</h3> <p>근간이 되는 브랜치는 master, develop 브랜치</p> <p>새로운 기능을 추가하는 브랜치로 feature/... 가 develop 브랜치에서 뻗어간다. 기능 구현이 완료되면 다시 develop 브랜치로 merge 하게된다.</p> <p>서비스 출시전 release 브랜치를 만들고 모든 구성원이 QA 를 할 수 있도록 한다. release 브랜치는 QA 동안 발견된 버그를 수정하며 출시 준비가 완료되면 master 브랜치로 merge 하며 출시를 완료하게 된다.</p> <p>서비스 출시 후 버그가 발생하면 hotfixes 브랜치를 만들고 버그 수정을 한다. 수정이 완료되면 출시된 master 브랜치로 merge 한다.</p> <p><img src="/TIL/assets/img/git-flow_overall_graph.f3ecc3cf.png" alt="git flow graph"></p> <h3 id="github-flow"><a href="#github-flow" aria-hidden="true" class="header-anchor">#</a> github flow</h3> <p>github flow 는 기능 개발을 위한 브랜치를 만들고 이를 리모트 저장소에 푸쉬하여 Pull Request 를 하는 전략이다. 이는 메인 브랜치(master)에 merge 하기 전 pull request 를 통해 구성원들의 리뷰를 받고 최종결정자가 merge 를 한다.</p> <h2 id="내-서비스를-github-action-을-통해-heorku-에-자동-배포해보기"><a href="#내-서비스를-github-action-을-통해-heorku-에-자동-배포해보기" aria-hidden="true" class="header-anchor">#</a> 내 서비스를 Github Action 을 통해 Heorku 에 자동 배포해보기</h2> <h3 id="heroku-란"><a href="#heroku-란" aria-hidden="true" class="header-anchor">#</a> Heroku 란?</h3> <p>Heroku 는 배포 준비된 웹 어플리케이션을 올릴 수 있는 플랫폼</p> <h3 id="heroku-배포방법"><a href="#heroku-배포방법" aria-hidden="true" class="header-anchor">#</a> Heroku 배포방법</h3> <ul><li>Heroku 앱이 만들어지면 Github 와 같은 리모트 저장소가 생성</li> <li>해당 리모트 저장소에 프로젝트를 푸쉬하게되면 준비된 커맨드를 실행해 배포를 진행</li></ul> <p>개인프로젝트 진행시에는 리모트 저장소를 Heroku 로 하고 직접 테스트를 진행하면서 배포를 직접하는 것이 적절한 방법인 것 같다.</p> <h3 id="github-action-을-사용하는-이유"><a href="#github-action-을-사용하는-이유" aria-hidden="true" class="header-anchor">#</a> Github Action 을 사용하는 이유</h3> <p>협업의 경우에는 얘기가 다르다. 여러 개발자가 하나의 프로젝트에 붙어 개발을 한다면 개발된 내용을 통합한 후 배포를 진행해야 할 것이다. 이것뿐만아니라 통합후 배포전 테스트를 진행하고 싶다면 바로 배포가 진행되는 Heroku 에 push 하면 안될것이다. 물론 Heroku 에는 pipeline 을 생성하여 배포 전에 다른 것을 수행할 수 있으나 비용이 추가될 수 있다.</p> <h3 id="spring-boot-앱-자동-배포-시작"><a href="#spring-boot-앱-자동-배포-시작" aria-hidden="true" class="header-anchor">#</a> Spring Boot 앱 자동 배포 시작</h3> <p>Github Action 은 .github/workflows 에 정의</p> <p>해당 코드는 Spring Boot 앱을 gradle 을 통해 테스트-빌드 진행, 이후 heroku 에 배포하는 일련의 과정을 정의한 것.</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token comment"># .github/workflows/&lt;...&gt;.yml</span>
<span class="token key atrule">name</span><span class="token punctuation">:</span> Jangpyunham Testing Demo
<span class="token key atrule">on</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>push<span class="token punctuation">]</span>
<span class="token key atrule">jobs</span><span class="token punctuation">:</span>
  <span class="token key atrule">Spring-Boot-Test-And-Build</span><span class="token punctuation">:</span>
    <span class="token key atrule">runs-on</span><span class="token punctuation">:</span> ubuntu<span class="token punctuation">-</span>latest <span class="token comment"># Linux환경에서 실행</span>
    <span class="token key atrule">steps</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">uses</span><span class="token punctuation">:</span> actions/checkout@v2 <span class="token comment"># repository 코드를 가져와 runner에 다운*</span>
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Set up JDK 11
        <span class="token key atrule">uses</span><span class="token punctuation">:</span> actions/setup<span class="token punctuation">-</span>java@v2 <span class="token comment"># jdk 다운로드</span>
        <span class="token key atrule">with</span><span class="token punctuation">:</span>
          <span class="token key atrule">java-version</span><span class="token punctuation">:</span> <span class="token string">'11'</span>
          <span class="token key atrule">distribution</span><span class="token punctuation">:</span> <span class="token string">'adopt'</span>
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Validate Gradle wrapper
        <span class="token key atrule">uses</span><span class="token punctuation">:</span> gradle/wrapper<span class="token punctuation">-</span>validation<span class="token punctuation">-</span>action@e6e38bacfdf1a337459f332974bb2327a31aaf4b
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Testing
        <span class="token key atrule">run</span><span class="token punctuation">:</span> ./gradlew build <span class="token comment"># 테스트 및 빌드 진행</span>
      <span class="token punctuation">-</span> <span class="token key atrule">uses</span><span class="token punctuation">:</span> akhileshns/heroku<span class="token punctuation">-</span>deploy@v3.12.12 <span class="token comment"># Heroku 배포</span>
        <span class="token key atrule">with</span><span class="token punctuation">:</span>
          <span class="token key atrule">heroku_api_key</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span><span class="token punctuation">{</span>secrets.HEROKU_API_KEY<span class="token punctuation">}</span><span class="token punctuation">}</span>
          <span class="token key atrule">heroku_app_name</span><span class="token punctuation">:</span> &quot;jangpyunham<span class="token punctuation">-</span>backend&quot; <span class="token comment">#Must be unique in Heroku</span>
          <span class="token key atrule">heroku_email</span><span class="token punctuation">:</span> <span class="token string">&quot;8735132@naver.com&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>이후에는 github 저장소에 push 되면 다음의 과정을 수행하게된다.</p> <h4 id="heroku-api-키-보안"><a href="#heroku-api-키-보안" aria-hidden="true" class="header-anchor">#</a> Heroku API 키 보안</h4> <p>heroku 에 배포하기 위해서는 API 키가 필요하게 되는데 문서에 그대로 넣게되면 협업하는 구성원들이 이를 확인하게되어 보안상 안좋다. secrets 을 통해 github action 에서 환경변수를 사용할 수 있게 하여 API 키를 확인할 수 없도록 하는게 좋을 것 같아 설정하였다.</p></div> <div class="page-edit"><!----> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/TIL/2021-11/24.html" class="prev">
          2021년 11월 24일
        </a></span> <!----></p></div> </div> <!----></div></div>
    <script src="/TIL/assets/js/app.8d80df15.js" defer></script><script src="/TIL/assets/js/17.4cf6d4c7.js" defer></script>
  </body>
</html>
